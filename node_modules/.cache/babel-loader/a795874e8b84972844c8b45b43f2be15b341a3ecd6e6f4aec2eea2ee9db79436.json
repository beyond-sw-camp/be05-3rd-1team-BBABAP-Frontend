{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, createTextVNode as _createTextVNode, withModifiers as _withModifiers, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, toDisplayString as _toDisplayString, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-9bda156e\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"map_wrap\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  id: \"map\",\n  style: {\n    \"width\": \"100%\",\n    \"height\": \"500px\",\n    \"position\": \"relative\",\n    \"overflow\": \"hidden\"\n  }\n}, null, -1 /* HOISTED */));\nconst _hoisted_3 = {\n  id: \"menu_wrap\",\n  class: \"bg_white\"\n};\nconst _hoisted_4 = {\n  class: \"option\"\n};\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\"\n}, \"검색하기\", -1 /* HOISTED */));\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1 /* HOISTED */));\nconst _hoisted_7 = {\n  id: \"placesList\"\n};\nconst _hoisted_8 = {\n  class: \"info\"\n};\nconst _hoisted_9 = {\n  class: \"jibun gray\"\n};\nconst _hoisted_10 = {\n  class: \"tel\"\n};\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  id: \"pagination\"\n}, null, -1 /* HOISTED */));\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", null, [_createElementVNode(\"form\", {\n    onSubmit: _cache[1] || (_cache[1] = _withModifiers((...args) => $options.searchPlaces && $options.searchPlaces(...args), [\"prevent\"]))\n  }, [_createTextVNode(\" 키워드 : \"), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.keyword = $event),\n    size: \"15\",\n    placeholder: \"전기차\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.keyword]]), _hoisted_5], 32 /* NEED_HYDRATION */)])]), _hoisted_6, _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => _ctx.findMyLocation && _ctx.findMyLocation(...args))\n  }, \"내 위치 찾기\"), _createElementVNode(\"ul\", _hoisted_7, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.places, (place, index) => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: index,\n      class: \"item\"\n    }, [_createElementVNode(\"span\", {\n      class: _normalizeClass('markerbg marker_' + (index + 1))\n    }, null, 2 /* CLASS */), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"h5\", null, _toDisplayString(place.place_name), 1 /* TEXT */), _createElementVNode(\"span\", null, _toDisplayString(place.road_address_name), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_9, _toDisplayString(place.address_name), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_10, _toDisplayString(place.phone), 1 /* TEXT */), _createElementVNode(\"span\", null, [_createElementVNode(\"button\", {\n      onClick: $event => $options.toggleFavorite(place)\n    }, _toDisplayString($options.isFavorite(place) ? '제거' : '추가'), 9 /* TEXT, PROPS */, _hoisted_11)])])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _hoisted_12])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","id","style","type","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","onSubmit","_cache","_withModifiers","args","$options","searchPlaces","_createTextVNode","$event","$data","keyword","size","placeholder","_hoisted_5","_hoisted_6","onClick","_ctx","findMyLocation","_hoisted_7","_Fragment","_renderList","places","place","index","key","_normalizeClass","_hoisted_8","_toDisplayString","place_name","road_address_name","_hoisted_9","address_name","_hoisted_10","phone","toggleFavorite","isFavorite","_hoisted_11","_hoisted_12"],"sources":["C:\\encore\\be05-3rd-1team-BBABAP-Frontend\\src\\components\\KakaoMap.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"map_wrap\">\n      <div id=\"map\" style=\"width: 100%; height: 500px; position: relative; overflow: hidden;\"></div>\n\n      <div id=\"menu_wrap\" class=\"bg_white\">\n        <div class=\"option\">\n          <div>\n            <form @submit.prevent=\"searchPlaces\">\n              키워드 : <input type=\"text\" v-model=\"keyword\" size=\"15\" placeholder=\"전기차\">\n              <button type=\"submit\">검색하기</button>\n            </form>\n          </div>\n        </div>\n        <hr>\n        <button @click=\"findMyLocation\">내 위치 찾기</button>\n        <ul id=\"placesList\">\n          <li v-for=\"(place, index) in places\" :key=\"index\" class=\"item\">\n            <span :class=\"'markerbg marker_' + (index + 1)\"></span>\n            <div class=\"info\">\n              <h5>{{ place.place_name }}</h5>\n              <span>{{ place.road_address_name }}</span>\n              <span class=\"jibun gray\">{{ place.address_name }}</span>\n              <span class=\"tel\">{{ place.phone }}</span>\n              <span>\n                <button @click=\"toggleFavorite(place)\">\n                  {{ isFavorite(place) ? '제거' : '추가' }}\n                </button>\n              </span>\n            </div>\n          </li>\n        </ul>\n        <div id=\"pagination\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"KakaoMap\",\n  props: {\n    favorites: {\n      type: Array,\n      default: () => []\n    }\n  },\n  data() {\n    return {\n      keyword: \"\",\n      places: [],\n      markers: [],\n      infoWindow: null // infoWindow 변수 추가\n    };\n  },\n  mounted() {\n    if (window.kakao && window.kakao.maps) {\n      this.initMap();\n    } else {\n      const script = document.createElement(\"script\");\n      script.onload = () => window.kakao.maps.load(this.initMap);\n      script.src =\n        \"//dapi.kakao.com/v2/maps/sdk.js?autoload=false&appkey=915cffed372954b7b44804ed422b9cf0&libraries=services\";\n      document.head.appendChild(script);\n    }\n  },\n  methods: {\n    initMap() {\n      const container = document.getElementById(\"map\");\n      const options = {\n        center: new window.kakao.maps.LatLng(37.566826, 126.9786567),\n        level: 3\n      };\n\n      this.map = new window.kakao.maps.Map(container, options);\n\n      // 전기차 충전소 마커를 표시합니다\n      this.displayElectricChargingStation();\n    },\n    displayElectricChargingStation() {\n      const ps = new window.kakao.maps.services.Places();\n      ps.categorySearch('OL7', this.placesSearchCB);\n    },\n    searchPlaces() {\n      if (!this.keyword.trim()) {\n        alert(\"키워드를 입력해주세요!\");\n        return;\n      }\n\n      // 검색을 place_name으로 변경\n      const ps = new window.kakao.maps.services.Places();\n      // ps.keywordSearch(this.keyword, this.placesSearchCB);\n      ps.keywordSearch(this.keyword, this.placesSearchCB, { useMapBounds: true });\n    },\n    placesSearchCB(data, status, pagination) {\n      if (status === window.kakao.maps.services.Status.OK) {\n        this.places = data;\n        this.displayPlaces();\n        this.displayPagination(pagination);\n      } else if (status === window.kakao.maps.services.Status.ZERO_RESULT) {\n        alert(\"검색 결과가 존재하지 않습니다.\");\n      } else if (status === window.kakao.maps.services.Status.ERROR) {\n        alert(\"검색 결과 중 오류가 발생했습니다.\");\n      }\n    },\n    displayPlaces() {\n      // 기존 마커 제거\n      this.removeMarkers();\n\n      const bounds = new window.kakao.maps.LatLngBounds();\n\n      // 검색 결과에 따라 마커 추가\n      this.places.forEach((place, index) => {\n        const position = new window.kakao.maps.LatLng(place.y, place.x);\n        const markerImage = new window.kakao.maps.MarkerImage(\n          \"https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_number_blue.png\",\n          new window.kakao.maps.Size(36, 37),\n          {\n            spriteSize: new window.kakao.maps.Size(36, 691),\n            spriteOrigin: new window.kakao.maps.Point(0, (index * 46) + 10),\n            offset: new window.kakao.maps.Point(13, 37)\n          }\n        );\n        const marker = new window.kakao.maps.Marker({\n          position,\n          image: markerImage\n        });\n\n        marker.setMap(this.map);\n        this.markers.push(marker);\n\n        bounds.extend(position);\n\n        window.kakao.maps.event.addListener(marker, 'click', () => {\n          this.closeInfoWindows();\n          this.displayInfoWindow(place);\n        });\n      });\n\n      this.map.setBounds(bounds);\n    },\n    closeInfoWindows() {\n      if (this.infoWindow) {\n        this.infoWindow.setMap(null);\n      }\n    },\n    displayInfoWindow(place) {\n  const infoWindowStyle = `\n    padding: 10px;\n    background-color: rgba(255, 255, 255, 0.9);\n    border: 1px solid #ccc;\n    border-radius: 5px;\n    box-shadow: 3px 3px 5px rgba(0, 0, 0, 0.2);\n    max-width: 300px;\n    text-align: left;\n    position: absolute;\n    z-index: 1;\n  `;\n\n  const content = `\n    <div id=\"infoWindowContent\" style=\"${infoWindowStyle}\">\n      <h5>${place.place_name}</h5>\n      <p>${place.road_address_name}</p>\n      <p class=\"jibun gray\">${place.address_name}</p>\n      <p class=\"tel\">${place.phone}</p>\n      <button id=\"favoriteButton\">\n        즐겨찾기 ${this.isFavorite(place) ? '제거' : '추가'}\n      </button>\n    </div>\n  `;\n\n  const position = new window.kakao.maps.LatLng(place.y, place.x);\n  const overlay = new window.kakao.maps.CustomOverlay({\n    content: content,\n    map: this.map,\n    position: position\n  });\n\n  // 즐겨찾기 버튼에 대한 클릭 이벤트 처리\n  const button = document.getElementById('favoriteButton');\n  button.addEventListener('click', () => {\n    this.addToFavorites(place);\n  });\n\n  this.infoWindow = overlay;\n},\n\n    addToFavorites(place) {\n      if (!this.isFavorite(place)) {\n        this.addFavorite(place);\n      } else {\n        this.removeFavorite(place);\n      }\n    },\n    displayPagination(pagination) {\n      const paginationEl = document.getElementById(\"pagination\");\n      paginationEl.innerHTML = \"\";\n\n      for (let i = 1; i <= pagination.last; i++) {\n        const el = document.createElement(\"a\");\n        el.href = \"#\";\n        el.textContent = i;\n\n        if (i === pagination.current) {\n          el.className = \"on\";\n        } else {\n          el.onclick = () => {\n            pagination.gotoPage(i);\n          };\n        }\n\n        paginationEl.appendChild(el);\n      }\n    },\n    removeMarkers() {\n      this.markers.forEach(marker => marker.setMap(null));\n      this.markers = [];\n    },\n    toggleFavorite(place) {\n      if (this.isFavorite(place)) {\n        this.removeFavorite(place);\n      } else {\n        this.addFavorite(place);\n      }\n    },\n    async addFavorite(place) {\n      try {\n        const response = await fetch('http://localhost:3000/favorites', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(place)\n        });\n        if (response.ok) {\n          const data = await response.json();\n          this.$root.favorites.push(data);\n        } else {\n          console.error('Failed to add favorite');\n        }\n      } catch (error) {\n        console.error('Error adding favorite:', error);\n      }\n    },\n    async removeFavorite(place) {\n      try {\n        const index = this.$root.favorites.findIndex(favorite => favorite.place_name === place.place_name);\n        const response = await fetch(`http://localhost:3000/favorites/${this.$root.favorites[index].id}`, {\n          method: 'DELETE'\n        });\n        if (response.ok) {\n          this.$root.favorites.splice(index, 1);\n        } else {\n          console.error('Failed to remove favorite');\n        }\n      } catch (error) {\n        console.error('Error removing favorite:', error);\n      }\n    },\n    isFavorite(place) {\n      return this.favorites.some(favorite => favorite.place_name === place.place_name);\n    }\n  }\n};\n</script>\n\n<style scoped>\n/* 여기에 스타일을 추가합니다 */\n#menu_wrap {\n  background-color: rgba(255, 255, 255, 0.9);\n  padding: 15px;\n  border-radius: 10px;\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);\n}\n.option {\n  margin-bottom: 15px;\n  text-align: center;\n}\n.option input[type=\"text\"] {\n  width: 70%;\n  height: 30px;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  padding: 5px;\n}\n.option button[type=\"submit\"] {\n  width: 25%;\n  height: 36px;\n  border: none;\n  border-radius: 5px;\n  background-color: #007bff;\n  color: white;\n  cursor: pointer;\n}\n.option button[type=\"submit\"]:hover {\n  background-color: #0056b3;\n}\n#placesList {\n  padding: 0;\n  list-style: none;\n}\n#placesList .item {\n  border-bottom: 1px solid #ddd;\n  padding: 10px 0;\n}\n#placesList .item:last-child {\n  border-bottom: none;\n}\n#placesList .item h5 {\n  margin-bottom: 5px;\n}\n#placesList .item .info {\n  color: #666;\n}\n#placesList .item .tel {\n  color: #009900;\n}\n.item button {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 5px;\n  background-color: #28a745; /* Green color */\n  color: white;\n  cursor: pointer;\n  transition: background-color 0.3s ease;\n}\n\n.item button:hover {\n  background-color: #218838; /* Darker green color on hover */\n}\n\n.infoWindow {\n  padding: 10px;\n  background-color: rgba(255, 255, 255, 0.9); /* 밝은 배경색 */\n  border: 1px solid #ccc;\n  border-radius: 5px;\n  box-shadow: 3px 3px 5px rgba(0, 0, 0, 0.2);\n  max-width: 300px; /* 내용의 최대 너비 설정 */\n  text-align: left;\n  position: absolute;\n  z-index: 1;\n}\n\n.infoWindow h5 {\n  margin: 0 0 5px;\n  font-size: 16px;\n}\n.infoWindow p {\n  margin: 5px 0;\n}\n.infoWindow .tel {\n  color: #009900;\n}\n.infoWindow button {\n  display: block;\n  margin-top: 10px;\n  padding: 5px 10px;\n  border: none;\n  border-radius: 5px;\n  background-color: #28a745;\n  color: white;\n  cursor: pointer;\n}\n.infoWindow button:hover {\n  background-color: #218838;\n}\n</style>\n"],"mappings":";;;EAESA,KAAK,EAAC;AAAU;gEACnBC,mBAAA,CAA8F;EAAzFC,EAAE,EAAC,KAAK;EAACC,KAAyE,EAAzE;IAAA;IAAA;IAAA;IAAA;EAAA;;;EAETD,EAAE,EAAC,WAAW;EAACF,KAAK,EAAC;;;EACnBA,KAAK,EAAC;AAAQ;gEAIbC,mBAAA,CAAmC;EAA3BG,IAAI,EAAC;AAAQ,GAAC,MAAI;gEAIhCH,mBAAA,CAAI;;EAEAC,EAAE,EAAC;AAAY;;EAGVF,KAAK,EAAC;AAAM;;EAGTA,KAAK,EAAC;AAAY;;EAClBA,KAAK,EAAC;AAAK;oBAvB/B;iEAgCQC,mBAAA,CAA2B;EAAtBC,EAAE,EAAC;AAAY;;uBA/B1BG,mBAAA,CAkCM,cAjCJJ,mBAAA,CAgCM,OAhCNK,UAgCM,GA/BJC,UAA8F,EAE9FN,mBAAA,CA4BM,OA5BNO,UA4BM,GA3BJP,mBAAA,CAOM,OAPNQ,UAOM,GANJR,mBAAA,CAKM,cAJJA,mBAAA,CAGO;IAHAS,QAAM,EAAAC,MAAA,QAAAA,MAAA,MARzBC,cAAA,KAAAC,IAAA,KAQmCC,QAAA,CAAAC,YAAA,IAAAD,QAAA,CAAAC,YAAA,IAAAF,IAAA,CAAY;MAR/CG,gBAAA,CAQiD,SAC7B,G,gBAAAf,mBAAA,CAAiE;IAA1DG,IAAI,EAAC,MAAM;IATtC,uBAAAO,MAAA,QAAAA,MAAA,MAAAM,MAAA,IASgDC,KAAA,CAAAC,OAAO,GAAAF,MAAA;IAAEG,IAAI,EAAC,IAAI;IAACC,WAAW,EAAC;iDAA/BH,KAAA,CAAAC,OAAO,E,GACzCG,UAAmC,C,gCAIzCC,UAAI,EACJtB,mBAAA,CAAgD;IAAvCuB,OAAK,EAAAb,MAAA,QAAAA,MAAA,UAAAE,IAAA,KAAEY,IAAA,CAAAC,cAAA,IAAAD,IAAA,CAAAC,cAAA,IAAAb,IAAA,CAAc;KAAE,SAAO,GACvCZ,mBAAA,CAeK,MAfL0B,UAeK,I,kBAdHtB,mBAAA,CAaKuB,SAAA,QA9BfC,WAAA,CAiBuCX,KAAA,CAAAY,MAAM,EAjB7C,CAiBsBC,KAAK,EAAEC,KAAK;yBAAxB3B,mBAAA,CAaK;MAbiC4B,GAAG,EAAED,KAAK;MAAEhC,KAAK,EAAC;QACtDC,mBAAA,CAAuD;MAAhDD,KAAK,EAlBxBkC,eAAA,uBAkBgDF,KAAK;6BACzC/B,mBAAA,CAUM,OAVNkC,UAUM,GATJlC,mBAAA,CAA+B,YAAAmC,gBAAA,CAAxBL,KAAK,CAACM,UAAU,kBACvBpC,mBAAA,CAA0C,cAAAmC,gBAAA,CAAjCL,KAAK,CAACO,iBAAiB,kBAChCrC,mBAAA,CAAwD,QAAxDsC,UAAwD,EAAAH,gBAAA,CAA5BL,KAAK,CAACS,YAAY,kBAC9CvC,mBAAA,CAA0C,QAA1CwC,WAA0C,EAAAL,gBAAA,CAArBL,KAAK,CAACW,KAAK,kBAChCzC,mBAAA,CAIO,eAHLA,mBAAA,CAES;MAFAuB,OAAK,EAAAP,MAAA,IAAEH,QAAA,CAAA6B,cAAc,CAACZ,KAAK;wBAC/BjB,QAAA,CAAA8B,UAAU,CAACb,KAAK,uCA1BrCc,WAAA,E;oCAgCQC,WAA2B,C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}